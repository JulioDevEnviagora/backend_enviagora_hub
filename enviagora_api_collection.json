{
    "info": {
        "_postman_id": "7a3b4c5d-1e2f-3g4h-5i6j-7k8l9m0n1o2p",
        "name": "Enviagora Hub API",
        "description": "Cole√ß√£o completa de rotas para o sistema de RH Enviagora Hub.\n\n**Como usar:**\n1. Importe esta collection no Postman\n2. A vari√°vel `base_url` j√° est√° configurada para `http://localhost:3005`\n3. Fa√ßa login primeiro (salva o cookie de sess√£o automaticamente)\n4. Execute os demais endpoints normalmente\n\n**Autentica√ß√£o:** Cookie-based (JWT via cookie `token`)",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "item": [
        {
            "name": "üîê Autentica√ß√£o",
            "item": [
                {
                    "name": "Login",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    console.log('‚úÖ Login realizado. Cookie de sess√£o salvo automaticamente.');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"admin@enviagora.com.br\",\n    \"password\": \"senha123\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/api/auth/login",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "auth",
                                "login"
                            ]
                        },
                        "description": "Realiza login no sistema. Em caso de sucesso, define um cookie `token` (JWT) que √© enviado automaticamente nas pr√≥ximas requisi√ß√µes.\n\n**Resposta de sucesso:**\n```json\n{\n  \"ok\": true,\n  \"user\": {\n    \"id\": \"uuid\",\n    \"nome\": \"Admin\",\n    \"email\": \"admin@enviagora.com.br\",\n    \"role\": \"admin\"\n  }\n}\n```"
                    },
                    "response": []
                },
                {
                    "name": "Verificar Sess√£o (Me)",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/auth/me",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "auth",
                                "me"
                            ]
                        },
                        "description": "Verifica se o usu√°rio est√° autenticado e retorna os dados do perfil atual."
                    },
                    "response": []
                },
                {
                    "name": "Logout",
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/auth/logout",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "auth",
                                "logout"
                            ]
                        },
                        "description": "Encerra a sess√£o do usu√°rio, removendo o cookie de autentica√ß√£o."
                    },
                    "response": []
                },
                {
                    "name": "Esqueci minha senha (Solicitar)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"usuario@enviagora.com.br\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/api/auth/forgot-password",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "auth",
                                "forgot-password"
                            ]
                        },
                        "description": "Gera um token de recupera√ß√£o de senha e envia para o e-mail do usu√°rio."
                    },
                    "response": []
                },
                {
                    "name": "Resetar Senha (com Token)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"usuario@enviagora.com.br\",\n    \"token\": \"TOKEN_RECEBIDO_POR_EMAIL\",\n    \"newPassword\": \"nova_senha_segura_123\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/api/auth/reset-password",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "auth",
                                "reset-password"
                            ]
                        }
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "üë• Colaboradores",
            "item": [
                {
                    "name": "Listar Todos",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/colaboradores",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "colaboradores"
                            ]
                        },
                        "description": "Lista todos os colaboradores cadastrados no sistema. Requer autentica√ß√£o."
                    },
                    "response": []
                },
                {
                    "name": "Buscar por ID",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/colaboradores/:id",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "colaboradores",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{colaborador_id}}",
                                    "description": "UUID do colaborador"
                                }
                            ]
                        }
                    },
                    "response": []
                },
                {
                    "name": "Criar Colaborador",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"nome\": \"Jo√£o Silva\",\n    \"email\": \"joao@enviagora.com.br\",\n    \"cpf\": \"123.456.789-00\",\n    \"password\": \"123456\",\n    \"role\": \"funcionario\",\n    \"matricula\": \"12345\",\n    \"codigo_holerite\": \"1001\",\n    \"setor\": \"Log√≠stica\",\n    \"cargo\": \"Ajudante\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/api/colaboradores",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "colaboradores"
                            ]
                        },
                        "description": "Cria um novo colaborador.\n\n**Campos importantes:**\n- `matricula`: Crach√°/matr√≠cula no Kairos (num√©rico) ‚Äî usado para buscar horas extras\n- `codigo_holerite`: C√≥digo para vincular PDFs automaticamente\n- `role`: `admin` ou `funcionario`"
                    },
                    "response": []
                },
                {
                    "name": "Editar Colaborador",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"nome\": \"Jo√£o Silva Editado\",\n    \"setor\": \"Transportes\",\n    \"matricula\": \"12345\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/api/colaboradores/:id",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "colaboradores",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{colaborador_id}}"
                                }
                            ]
                        }
                    },
                    "response": []
                },
                {
                    "name": "Alterar Senha",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"newPassword\": \"nova_senha_segura_456\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/api/colaboradores/:id/password",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "colaboradores",
                                ":id",
                                "password"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{colaborador_id}}"
                                }
                            ]
                        }
                    },
                    "response": []
                },
                {
                    "name": "Deletar Colaborador",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/colaboradores/:id",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "colaboradores",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{colaborador_id}}"
                                }
                            ]
                        }
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "üìÑ Holerites",
            "item": [
                {
                    "name": "Listar Holerites",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/holerites",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "holerites"
                            ]
                        },
                        "description": "Lista todos os holerites. Admin v√™ todos; funcion√°rio v√™ apenas os pr√≥prios."
                    },
                    "response": []
                },
                {
                    "name": "Upload de PDFs (Autom√°tico)",
                    "request": {
                        "method": "POST",
                        "header": [],
                        "body": {
                            "mode": "formdata",
                            "formdata": [
                                {
                                    "key": "competencia",
                                    "value": "01/2025",
                                    "description": "Compet√™ncia no formato MM/YYYY",
                                    "type": "text"
                                },
                                {
                                    "key": "files",
                                    "description": "Um ou mais arquivos PDF de holerites",
                                    "type": "file",
                                    "src": []
                                }
                            ]
                        },
                        "url": {
                            "raw": "{{base_url}}/api/holerites/upload",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "holerites",
                                "upload"
                            ]
                        },
                        "description": "**Somente Admin.** Faz upload em lote de PDFs. O sistema l√™ automaticamente o conte√∫do de cada PDF, identifica o funcion√°rio pelo c√≥digo interno e vincula ao colaborador correto no Supabase."
                    },
                    "response": []
                },
                {
                    "name": "Download Holerite",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/holerites/:id/download",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "holerites",
                                ":id",
                                "download"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{holerite_id}}",
                                    "description": "UUID do holerite"
                                }
                            ]
                        },
                        "description": "Faz download do PDF. Funcion√°rio s√≥ pode baixar os pr√≥prios holerites."
                    },
                    "response": []
                },
                {
                    "name": "Editar Holerite",
                    "request": {
                        "method": "PUT",
                        "header": [],
                        "body": {
                            "mode": "formdata",
                            "formdata": [
                                {
                                    "key": "competencia",
                                    "value": "02/2025",
                                    "type": "text"
                                },
                                {
                                    "key": "file",
                                    "description": "Novo PDF (opcional ‚Äî substitui o atual)",
                                    "type": "file",
                                    "src": []
                                }
                            ]
                        },
                        "url": {
                            "raw": "{{base_url}}/api/holerites/:id",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "holerites",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{holerite_id}}"
                                }
                            ]
                        }
                    },
                    "response": []
                },
                {
                    "name": "Deletar Holerite",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/holerites/:id",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "holerites",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{holerite_id}}"
                                }
                            ]
                        }
                    },
                    "response": []
                },
                {
                    "name": "Resumo Estat√≠stico",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/holerites/stats/summary",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "holerites",
                                "stats",
                                "summary"
                            ]
                        },
                        "description": "Retorna estat√≠sticas gerais dos holerites cadastrados."
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "‚è∞ Controle de Ponto ‚Äî Horas Extras",
            "description": "Endpoints para consulta de horas extras via integra√ß√£o com a API Kairos.\n\n**Fluxo para funcion√°rio:**\n1. GET /minha-matricula ‚Üí obt√©m o crach√°\n2. GET /horas-extras/:matricula ‚Üí obt√©m as horas extras\n\n**Fluxo para admin:**\n1. GET /horas-extras/admin ‚Üí painel completo",
            "item": [
                {
                    "name": "Minha Matr√≠cula",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/controle-ponto/minha-matricula",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "controle-ponto",
                                "minha-matricula"
                            ]
                        },
                        "description": "Retorna a matr√≠cula (crach√°) do usu√°rio logado a partir do Supabase.\n\n**Resposta de sucesso:**\n```json\n{\n  \"ok\": true,\n  \"data\": {\n    \"id\": \"uuid\",\n    \"nome\": \"Jo√£o Silva\",\n    \"email\": \"joao@enviagora.com.br\",\n    \"matricula\": \"12345\",\n    \"mensagem\": \"Matr√≠cula encontrada\"\n  }\n}\n```\n\n**‚ö†Ô∏è Se matricula for null:** O usu√°rio n√£o possui matr√≠cula cadastrada no Supabase. Cadastre via endpoint de Colaboradores."
                    },
                    "response": []
                },
                {
                    "name": "Horas Extras ‚Äî Individual (por matr√≠cula)",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/controle-ponto/horas-extras/{{matricula}}",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "controle-ponto",
                                "horas-extras",
                                "{{matricula}}"
                            ],
                            "variable": [
                                {
                                    "key": "matricula",
                                    "value": "12345",
                                    "description": "Crach√°/matr√≠cula num√©rica do funcion√°rio no Kairos"
                                }
                            ]
                        },
                        "description": "Consulta horas extras dos √∫ltimos 30 dias de um funcion√°rio espec√≠fico via API Kairos.\n\n**Internamente envia para Kairos:**\n```json\n{\n  \"IdsPessoa\": [12345],\n  \"DataInicio\": \"DD-MM-YYYY\",\n  \"DataFim\": \"DD-MM-YYYY\",\n  \"RequestType\": \"2\",\n  \"ResponseType\": \"AS400V1\"\n}\n```\n\n**Resposta de sucesso:**\n```json\n{\n  \"ok\": true,\n  \"data\": {\n    \"cracha\": 12345,\n    \"periodo\": {\n      \"dataInicio\": \"21-01-2025\",\n      \"dataFim\": \"20-02-2025\",\n      \"automatico\": true\n    },\n    \"totalMinutos\": 180,\n    \"totalHorasFormatado\": \"03:00\",\n    \"totalHorasDecimal\": \"3.00\",\n    \"detalhes\": [\n      {\n        \"data\": \"2025-02-10\",\n        \"tipoHoraExtra\": \"HE 50%\",\n        \"quantidadeMinutos\": 90,\n        \"quantidadeHorasFormatado\": \"01:30\"\n      }\n    ]\n  }\n}\n```\n\n**Erros comuns:**\n- `400` ‚Äî Matr√≠cula inv√°lida ou n√£o num√©rica\n- `500` ‚Äî Falha na comunica√ß√£o com Kairos"
                    },
                    "response": []
                },
                {
                    "name": "Horas Extras ‚Äî Painel Admin",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/controle-ponto/horas-extras/admin",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "controle-ponto",
                                "horas-extras",
                                "admin"
                            ]
                        },
                        "description": "**Somente Admin.** Busca horas extras de TODOS os funcion√°rios cadastrados no Kairos nos √∫ltimos 30 dias.\n\nO endpoint:\n1. Busca todos os funcion√°rios via `People/SearchPeople` (com pagina√ß√£o)\n2. Busca horas extras via `ExtraHour/GetExtraHours` em lotes de 10 (concorr√™ncia limitada)\n3. Consolida e retorna ranking + resumo\n\n**Resposta de sucesso:**\n```json\n{\n  \"ok\": true,\n  \"data\": {\n    \"periodo\": {\n      \"dataInicio\": \"21-01-2025\",\n      \"dataFim\": \"20-02-2025\"\n    },\n    \"resumo\": {\n      \"totalFuncionarios\": 42,\n      \"funcionariosComHorasExtras\": 15,\n      \"totalGeralMinutos\": 2400,\n      \"totalGeralHorasFormatado\": \"40:00\",\n      \"totalGeralHorasDecimal\": \"40.00\",\n      \"mediaHorasDecimal\": \"2.67\"\n    },\n    \"funcionarios\": [\n      {\n        \"funcionario\": {\n          \"cracha\": 12345,\n          \"matricula\": \"12345\",\n          \"nome\": \"Jo√£o Silva\",\n          \"cargo\": \"Ajudante\"\n        },\n        \"totalMinutos\": 180,\n        \"totalHorasFormatado\": \"03:00\",\n        \"totalHorasDecimal\": \"3.00\",\n        \"totalRegistros\": 2\n      }\n    ]\n  }\n}\n```\n\n**‚ö†Ô∏è Aten√ß√£o:** Esta rota pode demorar de 10 a 60 segundos dependendo do n√∫mero de funcion√°rios."
                    },
                    "response": []
                },
                {
                    "name": "Horas Extras ‚Äî Todos (POST com per√≠odo customizado)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"dataInicio\": \"01-01-2025\",\n    \"dataFim\": \"31-01-2025\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/api/controle-ponto/horas-extras",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "controle-ponto",
                                "horas-extras"
                            ]
                        },
                        "description": "Consulta horas extras de todos os funcion√°rios em um per√≠odo customizado.\n\n**Campos do payload:**\n- `dataInicio`: Formato `DD-MM-YYYY`\n- `dataFim`: Formato `DD-MM-YYYY`\n\n**Internamente envia para Kairos (por funcion√°rio):**\n```json\n{\n  \"IdsPessoa\": [12345],\n  \"DataInicio\": \"01-01-2025\",\n  \"DataFim\": \"31-01-2025\",\n  \"RequestType\": \"2\",\n  \"ResponseType\": \"AS400V1\"\n}\n```"
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "üì£ Avisos e Comunicados",
            "item": [
                {
                    "name": "Listar Avisos",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/announcements",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "announcements"
                            ]
                        },
                        "description": "Lista todos os avisos internos publicados."
                    },
                    "response": []
                },
                {
                    "name": "Criar Aviso",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"titulo\": \"Reuni√£o obrigat√≥ria\",\n    \"conteudo\": \"Todos os colaboradores devem comparecer √† reuni√£o na sexta-feira √†s 14h.\",\n    \"tipo\": \"urgente\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/api/announcements",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "announcements"
                            ]
                        },
                        "description": "**Somente Admin.** Cria um novo aviso interno.\n\n**Tipos dispon√≠veis:** `informativo`, `alerta`, `urgente`"
                    },
                    "response": []
                },
                {
                    "name": "Deletar Aviso",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/api/announcements/:id",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "api",
                                "announcements",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{aviso_id}}"
                                }
                            ]
                        }
                    },
                    "response": []
                }
            ]
        }
    ],
    "event": [
        {
            "listen": "prerequest",
            "script": {
                "type": "text/javascript",
                "exec": [
                    ""
                ]
            }
        },
        {
            "listen": "test",
            "script": {
                "type": "text/javascript",
                "exec": [
                    ""
                ]
            }
        }
    ],
    "variable": [
        {
            "key": "base_url",
            "value": "http://localhost:3005",
            "type": "string",
            "description": "URL base do backend. Altere para a URL de produ√ß√£o quando necess√°rio."
        },
        {
            "key": "matricula",
            "value": "12345",
            "type": "string",
            "description": "Crach√°/matr√≠cula num√©rica do funcion√°rio no Kairos. Substitua pelo n√∫mero real."
        },
        {
            "key": "colaborador_id",
            "value": "",
            "type": "string",
            "description": "UUID do colaborador no Supabase"
        },
        {
            "key": "holerite_id",
            "value": "",
            "type": "string",
            "description": "UUID do holerite no Supabase"
        },
        {
            "key": "aviso_id",
            "value": "",
            "type": "string",
            "description": "UUID do aviso no Supabase"
        }
    ]
}